<!doctype html><html><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.80.0"><title>How to setup a simple Heroku pipeline ‚Ä¢ A blog by st3v3nhunt</title><meta name=twitter:card content="summary"><meta name=twitter:title content="How to setup a simple Heroku pipeline"><meta name=twitter:description content="Pipelines in Heroku are pretty awesome. This is how I went about setting up a Node."><meta property="og:title" content="How to setup a simple Heroku pipeline"><meta property="og:description" content="Pipelines in Heroku are pretty awesome. This is how I went about setting up a Node."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.st3v3nhunt.me/posts/development/how-to-setup-a-simple-heroku-pipeline/"><meta property="article:published_time" content="2016-02-03T00:00:00+00:00"><meta property="article:modified_time" content="2016-02-04T00:00:00+00:00"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai-sublime.min.css><link rel=stylesheet href=/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css integrity="sha256-cRV+doxOERojw1MbleDLtZu+88nmkB02JHy1PWtr4lg="><link rel=stylesheet href=/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><div class=sidebar><div class=container><div class=sidebar-about><span class=site__title><a href=https://blog.st3v3nhunt.me>A blog by st3v3nhunt</a></span><p class=site__description></p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>A blog by st3v3nhunt</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=/posts/><span>Posts</span></a></li></ul></div><section class=social><a href=https://twitter.com/st3v3nhunt rel=me><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a><a href=https://github.com/st3v3nhunt rel=me><i class="fab fa-github fa-lg" aria-hidden=true></i></a></section></div></div><div class=copyright>&copy; 2022 st3v3nhunt
<a href=https://creativecommons.org/licenses/by-sa/4.0>CC BY-SA 4.0</a></div><div class=builtwith>Built with <a href=https://gohugo.io>Hugo</a> ‚ù§Ô∏è <a href=https://github.com/htr3n/hyde-hyde>hyde-hyde</a>.</div></div></div><div class="content container"><article><header><h1>How to setup a simple Heroku pipeline</h1><div class=post__meta><i class="fas fa-calendar-alt"></i>03-02-2016
in
<a class="badge badge-category" href=/categories/development>DEVELOPMENT</a><br><i class="fas fa-tags"></i><a class="badge badge-tag" href=/tags/cd>cd</a>
<a class="badge badge-tag" href=/tags/development>development</a>
<a class="badge badge-tag" href=/tags/heroku>heroku</a>
<a class="badge badge-tag" href=/tags/pipelines>pipelines</a>
<a class="badge badge-tag" href=/tags/practices>practices</a><br><i class="fas fa-clock"></i>4 min read</div></header><div class=post><p><a href=https://devcenter.heroku.com/articles/pipelines>Pipelines in Heroku</a> are
pretty awesome. This is how I went about setting up a Node.js app to have
automated deployments for all pull requests, an automated deployment to the
staging environment and a manual stage for promoting to the production
environment. Pretty much a bread and butter pipeline.
<em>(This is an image heavy post)</em></p><h3 id=pre-requisites>Pre-requisites:</h3><ul><li>Existing Node.js app hosted in GitHub (it doesn&rsquo;t need to be GitHub. Dropbox
and local git repos are supported by Heroku but pipelines have special
features for GitHub repos). Feel free to fork the
<a href=https://github.com/st3v3nhunt/node-js-getting-started>node-js-getting-started repo</a>
I used.</li><li>An Heroku account (obvs üòâ).</li></ul><h2 id=setting-up-the-pipeline>Setting up the pipeline:</h2><h3 id=an-app-for-staging-and-review-apps-for-pull-requests>An app for staging and review apps for pull requests.</h3><p>I started by creating a new app in Heroku. I named it
<code>name-not-in-use-staging</code>, note the end of the name i.e. <code>-staging</code>. I did this
to make it easier to recognise which app is which when I add them to the
pipeline:
<img src=/images/pipelines/create-new-app.png alt="New app"></p><p>On the same screen I selected <code>Show more options...</code> so I could add the app to
a new pipeline. I named the pipeline <code>pipeline-test</code> and I assigned the app to
the <code>staging</code> slot:
<img src=/images/pipelines/create-new-app-add-to-pipeline.png alt="Add to pipeline"></p><p>I then selected <code>Create App</code> which goes to this screen:
<img src=/images/pipelines/app-created-and-added-to-pipeline.png alt="Created app"></p><p>Note the deployment method section. I followed the instructions and connected
the app to my GitHub repo -
<a href=https://github.com/st3v3nhunt/node-js-getting-started>st3v3nhunt/node-js-getting-started</a>.
I also opted for automatic deployments from the <code>master</code> branch, as seen below:
<img src=/images/pipelines/connect-to-github-and-setup-auto-deployments.png alt="App connected to GitHub"></p><p>A little further down the screen there is the
<a href=https://devcenter.heroku.com/articles/github-integration-review-apps>Review apps</a>
section. As this app is part of a pipeline, review apps are managed by the
pipeline.</p><p><img src=/images/pipelines/begin-review-app-setup.png alt="Review app setup link"></p><p>Following the link to manage review apps shows us the visualisation of the
pipeline for the first time:
<img src=/images/pipelines/enable-review-apps.png alt="Enable review apps in pipeline"></p><p>It&rsquo;s worth noting if your repository doesn&rsquo;t include an <code>app.json</code> file you
will be prompted to create one for the configuration of review apps. The
default options will be sufficient for getting the pipeline up and running.
{: .notice}</p><p>Selecting to <code>Enable Review Apps</code> pops up this screen:
<img src=/images/pipelines/set-review-apps-auto-deploy.png alt="Setup review apps for all pull requests"></p><p>Where I opt for creating a review app for every pull request automatically.</p><p>When review apps are configured the pipeline will look like this:
<img src=/images/pipelines/pipeline-with-review-apps.png alt="Review apps setup in pipeline"></p><p>Note there is nothing in the production slot. Next I will go through what to do
in order to make it possible to have your staging app be promoted to
production.</p><h3 id=add-an-app-for-production>Add an app for production</h3><p>In order to have an app in production I need to create another app. In the
screen below, note how the name is appended with <code>-prod</code>. As with the staging
app, this is just a convention I use to help identify which app is which. In
this step I have assigned the app to the production slot within the pipeline.</p><p><img src=/images/pipelines/create-second-app-add-to-pipeline-prod.png alt="Create production app"></p><p>The pipeline is now complete. It will look something like this:
<img src=/images/pipelines/bare-bones-pipeline-no-deployments.png alt="Bare bones pipeline setup"></p><h2 id=pipeline-in-action>Pipeline in action</h2><p>Over the next few screens I&rsquo;ll show what happens to the pipeline as a pull
request is created and flows through the application from being merged into
master then promoted to production.</p><p>Pull requests are automatically deployed as part of the review apps
functionality. The review app gives people involved in the pull request the
opportunity to test the changes in an environment that is not where is was
developed. No more
<a href=http://blog.codinghorror.com/the-works-on-my-machine-certification-program/>&lsquo;works on my machine&rsquo;</a>
cries!
Not only is this good for providing an isolated test environment it also gets
around problems that geographically dispersed people can find themselves in.
I&rsquo;ve had numerous occasions where the person I wanted to run through something
with was not able to access my development machine. No more will that be a
problem!</p><p><img src=/images/pipelines/review-app-for-pull-request.png alt="Auto deployed review app"></p><p>Once a pull request has been merged into <code>master</code> it will be automatically
deployed into the staging environment:
<img src=/images/pipelines/merged-pr-auto-deployed-to-staging.png alt="Auto deployment to staging"></p><p>As seen in the screen above, there is now a button to promote to production.</p><p>Clicking on the &lsquo;Promote to production&mldr;&rsquo; button pops up the promote screen:
<img src=/images/pipelines/promote-staging-to-production.png alt="Promote staging to production"></p><p>Simply selecting &lsquo;Promote&rsquo; and when the changes have been promoted to
production this is what the pipeline will look like:
<img src=/images/pipelines/promoted-to-production-app.png alt="Production running latest code"></p><p>Additional pull requests will go through the same cycle.</p><h2 id=further-reading>Further reading</h2><p>Clearly this is a simple setup. Hopefully it has shown just how easy it is to
get a pipeline setup in Heroku.</p><p>There is a host of guides available on Heroku, the
<a href=https://devcenter.heroku.com/articles/pipelines>pipeline guide</a> is good place
to start if you are interested in finding out more.</p></div><div class="navigation navigation-single"><a href=/posts/development/fetch-remote-git-branches/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i><span class=navigation-tittle>Fetch remote Git branches</span></a>
<a href=/posts/development/hack-day/ class=navigation-next><span class=navigation-tittle>Hack day lite</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-21223368-5','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script defer src=https://use.fontawesome.com/releases/v5.12.1/js/all.js integrity=sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js></script><script type=text/javascript>hljs.initHighlightingOnLoad();</script></body></html>