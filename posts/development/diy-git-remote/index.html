<!doctype html><html><head><link href=https://gmpg.org/xfn/11 rel=profile><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=generator content="Hugo 0.80.0"><title>DIY git remotes • A blog by st3v3nhunt</title><meta name=twitter:card content="summary"><meta name=twitter:title content="DIY git remotes"><meta name=twitter:description content="Working with a non-cloud hosted Git remote I often work in environments where the code is centrally stored in TFS."><meta property="og:title" content="DIY git remotes"><meta property="og:description" content="Working with a non-cloud hosted Git remote I often work in environments where the code is centrally stored in TFS."><meta property="og:type" content="article"><meta property="og:url" content="https://st3v3nhunt.github.io/posts/development/diy-git-remote/"><meta property="article:published_time" content="2016-04-12T00:00:00+00:00"><meta property="article:modified_time" content="2016-04-12T00:00:00+00:00"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai-sublime.min.css><link rel=stylesheet href=/scss/hyde-hyde.71157e768c4e111a23c3531b95e0cbb59bbef3c9e6901d36247cb53d6b6be258.css integrity="sha256-cRV+doxOERojw1MbleDLtZu+88nmkB02JHy1PWtr4lg="><link rel=stylesheet href=/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58+TzH3icCkSHGoJ+ed7w=" media=print><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><div class=sidebar><div class=container><div class=sidebar-about><span class=site__title><a href=https://st3v3nhunt.github.io>A blog by st3v3nhunt</a></span><p class=site__description></p></div><div class=collapsible-menu><input type=checkbox id=menuToggle>
<label for=menuToggle>A blog by st3v3nhunt</label><div class=menu-content><div><ul class=sidebar-nav><li><a href=/posts/><span>Posts</span></a></li></ul></div><section class=social><a href=https://twitter.com/st3v3nhunt rel=me><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a><a href=https://github.com/st3v3nhunt rel=me><i class="fab fa-github fa-lg" aria-hidden=true></i></a></section></div></div><div class=copyright>&copy; 2021 st3v3nhunt
<a href=https://creativecommons.org/licenses/by-sa/4.0>CC BY-SA 4.0</a></div><div class=builtwith>Built with <a href=https://gohugo.io>Hugo</a> ❤️ <a href=https://github.com/htr3n/hyde-hyde>hyde-hyde</a>.</div></div></div><div class="content container"><article><header><h1>DIY git remotes</h1><div class=post__meta><i class="fas fa-calendar-alt"></i>12-04-2016
in
<a class="badge badge-category" href=/categories/development>DEVELOPMENT</a><br><i class="fas fa-tags"></i><a class="badge badge-tag" href=/tags/development>development</a>
<a class="badge badge-tag" href=/tags/git>git</a>
<a class="badge badge-tag" href=/tags/tfs>tfs</a>
<a class="badge badge-tag" href=/tags/vcs>vcs</a>
<a class="badge badge-tag" href=/tags/ways-of-working>ways-of-working</a><br><i class="fas fa-clock"></i>4 min read</div></header><div class=post><h2 id=working-with-a-non-cloud-hosted-git-remote>Working with a non-cloud hosted Git remote</h2><p>I often work in environments where the code is centrally stored in TFS. And as
I hate, HATE, <strong>HATE</strong> TFS I have to find other ways to interact with the VCS
to keep my sanity. <a href=http://git-tfs.com/>GitTFS</a> to the rescue. I&rsquo;ve written
about this <a href=https://st3v3nhunt.github.io/how-i-work-with-git-and-tfs/>before</a>.</p><p>I have a number of colleagues who feel the same way about TFS but until
recently we were happy to use the shelveset feature to do code reviews.
However, after a period of time doing &lsquo;proper&rsquo; reviews in
<a href=https://github.com/>GitHub</a> and <a href=https://gitlab.com/>GitLab</a> one of my
colleagues decided enough was enough and we should do a more Git based code
review. I was up for doing that and immediately thought we should get the code
into our internal GitLab instance. They didn&rsquo;t want to do that and instead
preferred to use their own machine as the remote host. Rather than go into the
details of why we decided this was OK I&rsquo;d like to cover the details of the work
flow.</p><h2 id=local-network-shared-git-repo-work-flow>Local network shared Git repo work flow</h2><p>The following describes how to work with a &lsquo;local&rsquo; (local network share) remote
Git repo. This allows a team of developers working with GitTFS to implement a
code review system in Git where it is not possible to make changes to the
server based TFS system.</p><h3 id=create-network-share>Create network share</h3><p>On a machine that is accessible by all members of the team a network share
needs to be created. This network share should contain the git repo that has
been created by GitTFS from the TFS source.</p><p>In the following example the network share machine is <code>WORKSRV_001</code> and the
location of the GitTFS repo is <code>C:\code\my-project</code></p><p>The following commands should be run on a machine that is not where the network
share is (although this doesn&rsquo;t necessarily matter).</p><h3 id=get-the-repo>Get the repo</h3><p>If the directory where the commands are being run is already a Git repo (as it
was in my case) add a new remote:
<code>git remote add WORKSRV_001 //WORKSRV_001/C$/code/my-project</code></p><p>Followed by a check out of the <code>master</code> branch:
<code>git cob WORKSRV_001/master WORKSRV_001/master</code></p><p>If the directory is not a Git repo, clone it:
<code>git clone //WORKSRV_001/C$/code/my-project</code></p><h3 id=checkout-the-branch-to-review>Checkout the branch to review</h3><p>When your colleague informs you there is a branch available for review, that
branch needs to be checked out locally so it can be reviewed.
<code>git cob review/&lt;branch-name> WORKSRV_001/&lt;branch-name></code></p><p>Follow your normal review process and remember to include checking the latest
code changes recorded in TFS are contained in the review branch.</p><h3 id=merge-the-reviewed-branch-into-a-copy-of-master>Merge the reviewed branch into a copy of master</h3><p>Once the branch has been reviewed it can be merged into a copy of <code>master</code>. The
reason for merging into a copy of <code>master</code> is because the remote is somebodies'
local Git repo and we don&rsquo;t want to go messing with it!
<code>git co WORKSRV_001/master</code>
<code>git cob reviewed/&lt;pull-request-description></code></p><p>When the copy of master is checked out the merge of the reviewed branch can
occur. This is done by creating a merge commit (the default behaviour of GitHub
and GitLab). To create a merge commit use the following options:</p><ul><li>no fast forward with <code>--no-ff</code></li><li>add a message with <code>-m "my commit message"</code></li><li>include the previous commit messages with <code>--log</code></li></ul><p><code>git merge --no-ff -m "&lt;message>" --log review/&lt;branch-name></code></p><h3 id=check-into-tfs>Check into TFS</h3><p>The reviewed and merged branch should now exist on the network shared Git repo.
The person whose machine hosts the network share needs to be informed of the
branch and that it should be pushed to TFS.</p><p>The push to TFS involves using GitTFS to checkin the changes:
<code>git-tfs checkin -m "&lt;message here>"</code></p><p>Hopefully no additional changes have been made to TFS during the review
process. If there are changes, the pusher will need to rebase the reviewed
branch against the latest changes (or ask one of the people involved in the
reviewed branch to do it) prior to checking it in.</p></div><div class="navigation navigation-single"><a href=/posts/development/git-aliases/ class=navigation-prev><i aria-hidden=true class="fa fa-chevron-left"></i><span class=navigation-tittle>Git aliases</span></a>
<a href=/posts/development/branch-based-nuget-packages-in-teacmity/ class=navigation-next><span class=navigation-tittle>Create branch based NuGet packages in TeamCity</span>
<i aria-hidden=true class="fa fa-chevron-right"></i></a></div></article></div><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-21223368-5','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script defer src=https://use.fontawesome.com/releases/v5.12.1/js/all.js integrity=sha384-ZbbbT1gw3joYkKRqh0kWyRp32UAvdqkpbLedQJSlnI8iLQcFVxaGyrOgOJiDQTTR crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js></script><script type=text/javascript>hljs.initHighlightingOnLoad();</script></body></html>